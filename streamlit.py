# import streamlit as st
# import pandas as pd
# import joblib
# import numpy as np

# # === Load components ===
# @st.cache_data
# def load_model_artifacts():
#     return {
#         "models": {
#             "Logistic Regression": joblib.load("models/logistic_regression.pkl"),
#             "Random Forest": joblib.load("models/random_forest.pkl"),
#             "XGBoost": joblib.load("models/xgboost.pkl")
#         },
#         "scaler": joblib.load("models/scaler.pkl"),
#         "features": joblib.load("models/feature_columns.pkl")
#     }

# merchant_list = ['fraud_Abbott-Rogahn', 'fraud_Abbott-Steuber', 'fraud_Abernathy and Sons', 'fraud_Abshire PLC', 'fraud_Adams, Kovacek and Kuhlman', 'fraud_Adams-Barrows', 'fraud_Altenwerth, Cartwright and Koss', 'fraud_Altenwerth-Kilback', 'fraud_Ankunding LLC', 'fraud_Ankunding-Carroll', 'fraud_Armstrong, Walter and Gottlieb', 'fraud_Auer LLC', 'fraud_Auer-Mosciski', 'fraud_Auer-West', 'fraud_Bahringer Group', 'fraud_Bahringer, Bergnaum and Quitzon', 'fraud_Bahringer, Osinski and Block', 'fraud_Bahringer, Schoen and Corkery', 'fraud_Bahringer-Larson', 'fraud_Bahringer-Streich', 'fraud_Bailey-Morar', 'fraud_Balistreri-Nader', 'fraud_Barrows PLC', 'fraud_Bartoletti and Sons', 'fraud_Bartoletti-Wunsch', 'fraud_Barton Inc', 'fraud_Barton LLC', 'fraud_Bashirian Group', 'fraud_Bauch-Blanda', 'fraud_Bauch-Raynor', 'fraud_Baumbach Ltd', 'fraud_Baumbach, Feeney and Morar', 'fraud_Baumbach, Hodkiewicz and Walsh', 'fraud_Baumbach, Strosin and Nicolas', 'fraud_Bechtelar-Rippin', 'fraud_Becker, Harris and Harvey', 'fraud_Bednar Group', 'fraud_Bednar Inc', 'fraud_Bednar PLC', 'fraud_Beer-Jast', 'fraud_Beier LLC', 'fraud_Beier and Sons', 'fraud_Beier-Hyatt', 'fraud_Berge LLC', 'fraud_Berge, Kautzer and Harris', 'fraud_Berge-Hills', 'fraud_Berge-Ullrich', 'fraud_Bernhard Inc', 'fraud_Bernhard, Grant and Langworth', 'fraud_Bernhard-Lesch', 'fraud_Bernier and Sons', 'fraud_Bernier, Streich and Jewess', 'fraud_Bernier, Volkman and Hoeger', 'fraud_Bins, Balistreri and Beatty', 'fraud_Bins-Howell', 'fraud_Bins-Rice', 'fraud_Bins-Tillman', 'fraud_Block Group', 'fraud_Block-Hauck', 'fraud_Block-Parisian', 'fraud_Bode-Rempel', 'fraud_Bode-Schuster', 'fraud_Boehm, Block and Jakubowski', 'fraud_Boehm, Predovic and Reinger', 'fraud_Bogisich Inc', 'fraud_Bogisich-Homenick', 'fraud_Bogisich-Weimann', 'fraud_Botsford Ltd', 'fraud_Botsford PLC', 'fraud_Botsford and Sons', 'fraud_Boyer PLC', 'fraud_Boyer-Haley', 'fraud_Boyer-Reichert', 'fraud_Bradtke PLC', 'fraud_Bradtke, Torp and Bahringer', 'fraud_Breitenberg LLC', 'fraud_Breitenberg-Hermiston', 'fraud_Brekke and Sons', 'fraud_Brown Inc', 'fraud_Brown PLC', 'fraud_Brown, Homenick and Lesch', 'fraud_Brown-Greenholt', 'fraud_Bruen-Yost', 'fraud_Buckridge PLC', 'fraud_Carroll PLC', 'fraud_Cartwright PLC', 'fraud_Cartwright-Harris', 'fraud_Casper, Hand and Zulauf', 'fraud_Cassin-Harvey', 'fraud_Champlin and Sons', 'fraud_Champlin, Rolfson and Connelly', 'fraud_Champlin-Casper', 'fraud_Christiansen, Goyette and Schamberger', 'fraud_Christiansen-Gusikowski', 'fraud_Cole PLC', 'fraud_Cole, Hills and Jewess', 'fraud_Collier Inc', 'fraud_Collier LLC', 'fraud_Connelly PLC', 'fraud_Connelly, Reichert and Fritsch', 'fraud_Connelly-Carter', 'fraud_Conroy Ltd', 'fraud_Conroy, Balistreri and Gorczany', 'fraud_Conroy-Cruickshank', 'fraud_Conroy-Emard', 'fraud_Cormier LLC', 'fraud_Cormier, Stracke and Thiel', 'fraud_Corwin-Collins', 'fraud_Corwin-Gorczany', 'fraud_Corwin-Romaguera', 'fraud_Cremin, Hamill and Reichel', 'fraud_Crist, Jakubowski and Littel', 'fraud_Crona and Sons', 'fraud_Cronin, Kshlerin and Weber', 'fraud_Crooks and Sons', 'fraud_Cruickshank-Mills', 'fraud_Cummerata-Hilpert', 'fraud_Cummerata-Jones', 'fraud_Cummings Group', 'fraud_Cummings LLC', 'fraud_Dach-Borer', 'fraud_Dach-Nader', 'fraud_Dare, Casper and Bartoletti', 'fraud_Dare, Fritsch and Zboncak', 'fraud_Dare-Gibson', 'fraud_Dare-Marvin', 'fraud_Daugherty LLC', 'fraud_Daugherty, Pouros and Beahan', 'fraud_Daugherty-Thompson', 'fraud_Deckow-Dare', "fraud_Deckow-O'Conner", 'fraud_Denesik and Sons', 'fraud_Denesik, Powlowski and Pouros', 'fraud_Dibbert and Sons', 'fraud_Dibbert-Green', 'fraud_Dicki Ltd', 'fraud_Dickinson Ltd', 'fraud_Dickinson-Rempel', 'fraud_Dietrich-Fadel', 'fraud_Donnelly LLC', 'fraud_Donnelly PLC', 'fraud_Dooley Inc', 'fraud_Dooley-Thompson', 'fraud_Douglas, DuBuque and McKenzie', 'fraud_Douglas, Schneider and Turner', 'fraud_Douglas-White', 'fraud_Doyle Ltd', 'fraud_DuBuque LLC', 'fraud_Durgan, Gislason and Spencer', 'fraud_Durgan-Auer', 'fraud_Ebert-Daugherty', 'fraud_Effertz LLC', 'fraud_Effertz, Welch and Schowalter', 'fraud_Eichmann, Bogan and Rodriguez', 'fraud_Eichmann, Hayes and Treutel', 'fraud_Eichmann-Kilback', 'fraud_Eichmann-Russel', 'fraud_Emard Inc', 'fraud_Emmerich-Luettgen', 'fraud_Emmerich-Rau', 'fraud_Erdman-Durgan', 'fraud_Erdman-Ebert', 'fraud_Erdman-Kertzmann', 'fraud_Erdman-Schaden', 'fraud_Ernser-Feest', 'fraud_Ernser-Lynch', 'fraud_Fadel Inc', 'fraud_Fadel, Mertz and Rippin', 'fraud_Fadel-Hilpert', 'fraud_Fahey Inc', 'fraud_Feil, Hilpert and Koss', 'fraud_Feil-Morar', 'fraud_Ferry, Lynch and Kautzer', 'fraud_Ferry, Reichel and DuBuque', 'fraud_Fisher Inc', 'fraud_Fisher-Schowalter', 'fraud_Flatley Group', 'fraud_Flatley-Durgan', 'fraud_Frami Group', 'fraud_Friesen Inc', 'fraud_Friesen Ltd', "fraud_Friesen-D'Amore", 'fraud_Friesen-Ortiz', 'fraud_Friesen-Stamm', 'fraud_Fritsch LLC', 'fraud_Fritsch and Sons', 'fraud_Funk Group', 'fraud_Gaylord-Powlowski', 'fraud_Gerhold LLC', 'fraud_Gerlach Inc', 'fraud_Gibson-Deckow', 'fraud_Gislason Group', 'fraud_Gleason and Sons', 'fraud_Gleason-Macejkovic', 'fraud_Goldner, Kovacek and Abbott', 'fraud_Goldner-Lemke', 'fraud_Goodwin-Nitzsche', 'fraud_Gottlieb Group', 'fraud_Gottlieb, Considine and Schultz', 'fraud_Gottlieb-Hansen', 'fraud_Goyette Inc', 'fraud_Goyette, Howell and Collier', 'fraud_Goyette-Gerhold', 'fraud_Goyette-Herzog', 'fraud_Graham and Sons', 'fraud_Graham, Hegmann and Hammes', 'fraud_Greenfelder, Bartoletti and Davis', 'fraud_Greenholt Ltd', 'fraud_Greenholt, Jacobi and Gleason', "fraud_Greenholt, O'Hara and Balistreri", 'fraud_Grimes LLC', 'fraud_Gulgowski LLC', 'fraud_Gutmann Ltd', 'fraud_Gutmann, McLaughlin and Wiza', 'fraud_Gutmann-Upton', 'fraud_Haag-Blanda', 'fraud_Hackett Group', 'fraud_Hackett-Lueilwitz', 'fraud_Hagenes, Hermann and Stroman', 'fraud_Hagenes, Kohler and Hoppe', 'fraud_Hahn, Bahringer and McLaughlin', 'fraud_Hahn, Douglas and Schowalter', 'fraud_Haley Group', 'fraud_Haley, Batz and Auer', 'fraud_Haley, Jewess and Bechtelar', 'fraud_Halvorson Group', "fraud_Hamill-D'Amore", 'fraud_Hamill-Daugherty', 'fraud_Hammes-Beatty', 'fraud_Harber Inc', 'fraud_Harris Group', 'fraud_Harris Inc', 'fraud_Harris, Gusikowski and Heaney', 'fraud_Hartmann, Rowe and Hermann', 'fraud_Hauck, Dietrich and Funk', 'fraud_Hayes, Marquardt and Dibbert', 'fraud_Heaney-Marquardt', 'fraud_Heathcote LLC', 'fraud_Heathcote, Yost and Kertzmann', 'fraud_Heidenreich PLC', 'fraud_Heller PLC', 'fraud_Heller, Gutmann and Zieme', 'fraud_Heller-Abshire', 'fraud_Heller-Langosh', 'fraud_Herman Inc', 'fraud_Herman, Treutel and Dickens', 'fraud_Hermann and Sons', 'fraud_Hermann-Gaylord', 'fraud_Hermiston, Pacocha and Smith', 'fraud_Hermiston, Russel and Price', 'fraud_Herzog Ltd', 'fraud_Hettinger, McCullough and Fay', 'fraud_Hickle Group', 'fraud_Hills, Hegmann and Schaefer', 'fraud_Hills-Boyer', 'fraud_Hills-Olson', 'fraud_Hills-Witting', 'fraud_Hilpert-Conroy', 'fraud_Hintz, Bauch and Smith', 'fraud_Hintz-Bruen', 'fraud_Hirthe-Beier', 'fraud_Hodkiewicz, Prohaska and Paucek', 'fraud_Homenick LLC', 'fraud_Hoppe, Harris and Bednar', 'fraud_Hoppe-Parisian', 'fraud_Howe Ltd', 'fraud_Howe PLC', 'fraud_Hudson-Grady', 'fraud_Hudson-Ratke', 'fraud_Huel Ltd', 'fraud_Huel, Hammes and Witting', 'fraud_Huel-Langworth', 'fraud_Huels-Hahn', 'fraud_Huels-Nolan', 'fraud_Hyatt, Russel and Gleichner', 'fraud_Hyatt-Blick', 'fraud_Jacobi Inc', 'fraud_Jacobi and Sons', 'fraud_Jakubowski Group', 'fraud_Jakubowski Inc', 'fraud_Jaskolski-Dibbert', 'fraud_Jaskolski-Vandervort', 'fraud_Jast Ltd', 'fraud_Jast and Sons', 'fraud_Jast-McDermott', 'fraud_Jenkins, Hauck and Friesen', 'fraud_Jerde-Hermann', 'fraud_Jewess LLC', 'fraud_Johns Inc', 'fraud_Johns-Hoeger', 'fraud_Johnson, Runolfsdottir and Mayer', 'fraud_Johnston, Nikolaus and Maggio', 'fraud_Johnston-Casper', 'fraud_Jones, Sawayn and Romaguera', 'fraud_Kassulke Inc', 'fraud_Kassulke PLC', 'fraud_Kautzer and Sons', 'fraud_Keeling-Crist', 'fraud_Kemmer-Buckridge', 'fraud_Kemmer-Reinger', 'fraud_Kerluke Inc', 'fraud_Kerluke PLC', 'fraud_Kerluke, Considine and Macejkovic', 'fraud_Kerluke, Kertzmann and Wiza', 'fraud_Kerluke-Abshire', 'fraud_Kertzmann LLC', 'fraud_Kessler Group', 'fraud_Kessler Inc', 'fraud_Kiehn Inc', 'fraud_Kiehn-Emmerich', 'fraud_Kihn Inc', 'fraud_Kihn, Abernathy and Douglas', 'fraud_Kihn, Brakus and Goyette', 'fraud_Kihn-Fritsch', 'fraud_Kihn-Schuster', 'fraud_Kilback Group', 'fraud_Kilback LLC', 'fraud_Kilback and Sons', 'fraud_Kilback, Nitzsche and Leffler', 'fraud_Kirlin and Sons', 'fraud_Klein Group', 'fraud_Kling Inc', 'fraud_Kling, Howe and Schneider', 'fraud_Kling-Ernser', 'fraud_Kling-Grant', 'fraud_Klocko LLC', 'fraud_Klocko, Runolfsdottir and Breitenberg', 'fraud_Koelpin and Sons', 'fraud_Koepp-Parker', 'fraud_Koepp-Witting', 'fraud_Kohler, Lindgren and Koelpin', 'fraud_Konopelski, Schneider and Hartmann', 'fraud_Koss and Sons', 'fraud_Koss, Hansen and Lueilwitz', 'fraud_Koss, McLaughlin and Mayer', 'fraud_Kovacek Ltd', 'fraud_Kovacek, Dibbert and Ondricka', 'fraud_Kozey-Boehm', 'fraud_Kozey-Kuhlman', 'fraud_Kozey-McDermott', 'fraud_Kris-Kertzmann', 'fraud_Kris-Padberg', 'fraud_Kris-Weimann', 'fraud_Kub PLC', 'fraud_Kub-Heaney', 'fraud_Kuhic Inc', 'fraud_Kuhic LLC', 'fraud_Kuhic, Bins and Pfeffer', 'fraud_Kuhn Group', 'fraud_Kuhn LLC', 'fraud_Kulas Group', 'fraud_Kunde-Sanford', 'fraud_Kunze Inc', 'fraud_Kunze, Larkin and Mayert', 'fraud_Kuphal-Bartoletti', 'fraud_Kuphal-Predovic', 'fraud_Kuphal-Toy', 'fraud_Kutch Group', 'fraud_Kutch LLC', 'fraud_Kutch and Sons', 'fraud_Kutch, Hermiston and Farrell', 'fraud_Kutch, Steuber and Gerhold', 'fraud_Kutch-Ferry', 'fraud_Kutch-Hegmann', 'fraud_Kutch-Wilderman', 'fraud_Kuvalis Ltd', 'fraud_Labadie LLC', 'fraud_Labadie, Treutel and Bode', 'fraud_Lakin, Ferry and Beatty', 'fraud_Lang, Towne and Schuppe', 'fraud_Langosh, Wintheiser and Hyatt', 'fraud_Langworth LLC', 'fraud_Langworth, Boehm and Gulgowski', 'fraud_Larkin Ltd', 'fraud_Larkin, Stracke and Greenfelder', 'fraud_Larson, Quitzon and Spencer', 'fraud_Larson-Moen', 'fraud_Leannon-Nikolaus', 'fraud_Leannon-Ward', 'fraud_Lebsack and Sons', 'fraud_Ledner, Hartmann and Feest', 'fraud_Ledner-Pfannerstill', 'fraud_Leffler-Goldner', 'fraud_Lehner, Mosciski and King', 'fraud_Lehner, Reichert and Mills', 'fraud_Lemke and Sons', 'fraud_Lemke-Gutmann', 'fraud_Lesch Ltd', "fraud_Lesch, D'Amore and Brown", 'fraud_Lind, Huel and McClure', 'fraud_Lind-Buckridge', 'fraud_Little Ltd', 'fraud_Little, Gutmann and Lynch', 'fraud_Little-Gleichner', 'fraud_Lockman Ltd', 'fraud_Lockman, West and Runte', 'fraud_Lowe, Dietrich and Erdman', 'fraud_Lubowitz, Terry and Stracke', 'fraud_Lubowitz-Walter', 'fraud_Luettgen PLC', 'fraud_Lynch Ltd', 'fraud_Lynch-Mohr', 'fraud_Lynch-Wisozk', 'fraud_Macejkovic-Lesch', 'fraud_Maggio-Fahey', 'fraud_Mante Group', 'fraud_Mante, Luettgen and Hackett', 'fraud_Marks Inc', 'fraud_Marvin-Lind', 'fraud_Mayert Group', 'fraud_McCullough Group', 'fraud_McCullough LLC', 'fraud_McCullough, Hudson and Schuster', 'fraud_McDermott, Osinski and Morar', 'fraud_McDermott-Rice', 'fraud_McDermott-Weimann', 'fraud_McGlynn-Heathcote', 'fraud_McGlynn-Jaskolski', 'fraud_McKenzie-Huels', 'fraud_McLaughlin, Armstrong and Koepp', 'fraud_Medhurst Inc', 'fraud_Medhurst PLC', 'fraud_Medhurst, Cartwright and Ebert', 'fraud_Medhurst, Labadie and Gottlieb', 'fraud_Metz, Russel and Metz', 'fraud_Metz-Boehm', 'fraud_Miller-Harris', 'fraud_Miller-Hauck', 'fraud_Moen, Reinger and Murphy', 'fraud_Mohr Inc', 'fraud_Mohr-Bayer', 'fraud_Monahan, Bogisich and Ledner', 'fraud_Monahan, Hermann and Johns', 'fraud_Monahan-Morar', 'fraud_Moore, Dibbert and Koepp', 'fraud_Moore, Williamson and Emmerich', 'fraud_Morar Inc', 'fraud_Morissette LLC', 'fraud_Morissette PLC', 'fraud_Morissette, Weber and Wiegand', 'fraud_Morissette-Schaefer', 'fraud_Mosciski Group', 'fraud_Mosciski, Gislason and Mertz', 'fraud_Mosciski, Ziemann and Farrell', 'fraud_Mraz-Herzog', 'fraud_Mueller, Gerhold and Mueller', 'fraud_Murray Ltd', 'fraud_Murray-Smitham', 'fraud_Nader-Heller', 'fraud_Nader-Maggio', 'fraud_Nicolas, Hills and McGlynn', 'fraud_Nienow PLC', 'fraud_Nienow, Ankunding and Collier', 'fraud_Nienow, Barrows and Romaguera', 'fraud_Nitzsche, Kessler and Wolff', 'fraud_Nolan-Williamson', "fraud_O'Connell, Botsford and Hand", "fraud_O'Connell-Ullrich", "fraud_O'Hara-Wilderman", "fraud_O'Keefe-Hudson", "fraud_O'Keefe-Wisoky", "fraud_O'Reilly, Mohr and Purdy", 'fraud_Okuneva, Schneider and Rau', 'fraud_Olson, Becker and Koch', 'fraud_Ortiz Group', 'fraud_Osinski Inc', 'fraud_Osinski, Ledner and Leuschke', 'fraud_Pacocha-Bauch', "fraud_Pacocha-O'Reilly", 'fraud_Pacocha-Weissnat', 'fraud_Padberg-Rogahn', 'fraud_Padberg-Sauer', 'fraud_Padberg-Welch', 'fraud_Pagac LLC', 'fraud_Parisian and Sons', 'fraud_Parisian, Schiller and Altenwerth', 'fraud_Parker, Nolan and Trantow', 'fraud_Parker-Kunde', 'fraud_Paucek-Wiza', 'fraud_Pfeffer LLC', 'fraud_Pfeffer and Sons', 'fraud_Pollich LLC', 'fraud_Pouros, Walker and Spencer', 'fraud_Pouros-Conroy', 'fraud_Pouros-Haag', 'fraud_Powlowski-Weimann', 'fraud_Predovic Inc', 'fraud_Price Inc', 'fraud_Prohaska-Murray', 'fraud_Prosacco LLC', 'fraud_Prosacco, Kreiger and Kovacek', 'fraud_Quitzon, Green and Bashirian', 'fraud_Quitzon-Goyette', 'fraud_Ratke and Sons', 'fraud_Rau and Sons', 'fraud_Rau-Grant', 'fraud_Rau-Robel', 'fraud_Raynor, Feest and Miller', 'fraud_Raynor, Reinger and Hagenes', 'fraud_Reichel Inc', 'fraud_Reichel LLC', 'fraud_Reichel, Bradtke and Blanda', 'fraud_Reichert, Huels and Hoppe', 'fraud_Reichert, Rowe and Mraz', 'fraud_Reichert, Shanahan and Hayes', 'fraud_Reichert-Weissnat', 'fraud_Reilly LLC', 'fraud_Reilly and Sons', 'fraud_Reilly, Heaney and Cole', 'fraud_Reinger, Weissnat and Strosin', 'fraud_Rempel Inc', 'fraud_Rempel PLC', 'fraud_Renner Ltd', 'fraud_Reynolds-Schinner', 'fraud_Rippin, Kub and Mann', 'fraud_Rippin-VonRueden', 'fraud_Ritchie, Bradtke and Stiedemann', 'fraud_Ritchie, Oberbrunner and Cremin', 'fraud_Robel, Cummerata and Prosacco', 'fraud_Roberts, Daniel and Macejkovic', 'fraud_Roberts, Ryan and Smith', 'fraud_Roberts-Beahan', 'fraud_Rodriguez Group', 'fraud_Rodriguez, Yost and Jenkins', 'fraud_Rohan, White and Aufderhar', 'fraud_Rolfson-Kunde', 'fraud_Romaguera Ltd', 'fraud_Romaguera and Sons', 'fraud_Romaguera, Cruickshank and Greenholt', 'fraud_Romaguera, Wehner and Tromp', 'fraud_Roob LLC', 'fraud_Roob, Conn and Tremblay', 'fraud_Roob-Okuneva', 'fraud_Rowe, Batz and Goodwin', 'fraud_Rowe-Vandervort', 'fraud_Ruecker Group', 'fraud_Ruecker, Beer and Collier', 'fraud_Ruecker-Mayert', 'fraud_Runolfsdottir, Mueller and Hand', 'fraud_Runolfsson and Sons', 'fraud_Runte, Green and Emard', 'fraud_Runte-Mohr', 'fraud_Rutherford, Homenick and Bergstrom', 'fraud_Rutherford-Mertz', 'fraud_Satterfield-Lowe', 'fraud_Sawayn PLC', 'fraud_Schaefer Ltd', 'fraud_Schaefer, Fay and Hilll', 'fraud_Schaefer, Maggio and Daugherty', 'fraud_Schaefer, McGlynn and Bosco', "fraud_Schamberger-O'Keefe", 'fraud_Schiller Ltd', 'fraud_Schiller, Blanda and Johnson', 'fraud_Schimmel-Olson', 'fraud_Schmeler Inc', 'fraud_Schmeler, Bashirian and Price', 'fraud_Schmeler-Howe', 'fraud_Schmidt and Sons', 'fraud_Schmidt-Larkin', 'fraud_Schmitt Inc', 'fraud_Schmitt Ltd', 'fraud_Schneider, Hayes and Nikolaus', 'fraud_Schoen Ltd', 'fraud_Schoen, Kuphal and Nitzsche', 'fraud_Schoen, Nienow and Bauch', 'fraud_Schoen-Quigley', 'fraud_Schroeder Group', 'fraud_Schroeder, Hauck and Treutel', 'fraud_Schroeder, Wolff and Hermiston', 'fraud_Schulist Ltd', 'fraud_Schultz, Simonis and Little', 'fraud_Schumm PLC', 'fraud_Schumm, Bauch and Ondricka', 'fraud_Schumm, McLaughlin and Carter', 'fraud_Schuppe LLC', 'fraud_Schuppe, Nolan and Hoeger', 'fraud_Schuppe-Schuppe', 'fraud_Shanahan-Lehner', 'fraud_Shields Inc', 'fraud_Shields-Wunsch', 'fraud_Simonis-Prohaska', 'fraud_Skiles LLC', 'fraud_Skiles-Ankunding', 'fraud_Smith-Stokes', 'fraud_Smitham-Boehm', 'fraud_Smitham-Schiller', 'fraud_Spencer PLC', 'fraud_Spencer-Runolfsson', 'fraud_Spinka Inc', 'fraud_Spinka-Welch', 'fraud_Sporer Inc', 'fraud_Sporer-Keebler', 'fraud_Stamm-Rodriguez', 'fraud_Stamm-Witting', 'fraud_Stanton, Jakubowski and Baumbach', 'fraud_Stark-Batz', 'fraud_Stark-Koss', 'fraud_Stehr, Jewess and Schimmel', 'fraud_Stiedemann Inc', 'fraud_Stiedemann Ltd', 'fraud_Stokes, Christiansen and Sipes', 'fraud_Stoltenberg-Beatty', 'fraud_Stracke-Lemke', 'fraud_Streich Ltd', 'fraud_Streich, Dietrich and Barton', 'fraud_Streich, Hansen and Veum', 'fraud_Streich, Rolfson and Wilderman', 'fraud_Stroman, Hudson and Erdman', 'fraud_Strosin-Cruickshank', 'fraud_Swaniawski, Bahringer and Ledner', 'fraud_Swaniawski, Lowe and Robel', 'fraud_Swaniawski, Nitzsche and Welch', 'fraud_Swift PLC', 'fraud_Swift, Bradtke and Marquardt', 'fraud_Terry Ltd', 'fraud_Terry, Johns and Bins', 'fraud_Terry-Huel', 'fraud_Thiel Ltd', 'fraud_Thiel PLC', 'fraud_Thiel-Thiel', 'fraud_Thompson-Gleason', 'fraud_Tillman LLC', 'fraud_Tillman, Dickinson and Labadie', 'fraud_Tillman, Fritsch and Schmitt', 'fraud_Torp, Muller and Borer', 'fraud_Torp-Labadie', 'fraud_Torp-Lemke', 'fraud_Torphy-Goyette', 'fraud_Torphy-Kertzmann', 'fraud_Towne LLC', 'fraud_Towne, Greenholt and Koepp', 'fraud_Towne, Walker and Borer', 'fraud_Trantow PLC', 'fraud_Treutel-King', 'fraud_Tromp Group', 'fraud_Tromp, Kerluke and Glover', 'fraud_Turcotte, Batz and Buckridge', 'fraud_Turcotte, McKenzie and Koss', 'fraud_Turcotte-Halvorson', 'fraud_Turner LLC', 'fraud_Turner and Sons', 'fraud_Turner, Ruecker and Parisian', 'fraud_Turner, Ziemann and Lehner', 'fraud_Ullrich Ltd', 'fraud_Upton PLC', 'fraud_Vandervort-Funk', 'fraud_Veum-Koelpin', 'fraud_Volkman Ltd', 'fraud_Volkman PLC', 'fraud_Volkman-Predovic', 'fraud_VonRueden Group', 'fraud_Waelchi Inc', 'fraud_Waelchi-Wolf', 'fraud_Walter, Hettinger and Kessler', 'fraud_Waters-Cruickshank', 'fraud_Watsica LLC', 'fraud_Watsica, Haag and Considine', 'fraud_Weber and Sons', 'fraud_Weber, Thiel and Hammes', 'fraud_Weimann, Kuhic and Beahan', 'fraud_Weimann-Lockman', 'fraud_Welch Inc', 'fraud_Welch, Rath and Koepp', 'fraud_White and Sons', 'fraud_Wiegand-Lowe', 'fraud_Wilkinson LLC', 'fraud_Wilkinson Ltd', 'fraud_Wilkinson PLC', 'fraud_Will Ltd', 'fraud_Williamson LLC', 'fraud_Willms, Kris and Bergnaum', 'fraud_Windler LLC', 'fraud_Windler, Goodwin and Kovacek', 'fraud_Wintheiser, Dietrich and Schimmel', 'fraud_Wisozk and Sons', 'fraud_Witting, Beer and Ernser', 'fraud_Wiza LLC', 'fraud_Wiza, Schaden and Stark', 'fraud_Wolf Inc', 'fraud_Wuckert, Wintheiser and Friesen', 'fraud_Wuckert-Goldner', 'fraud_Wuckert-Walter', 'fraud_Yost, Block and Koepp', 'fraud_Yost, Schamberger and Windler', 'fraud_Yost-Rogahn', 'fraud_Zboncak LLC', 'fraud_Zboncak Ltd', 'fraud_Zboncak, Rowe and Murazik', 'fraud_Zemlak Group', 'fraud_Zemlak, Tillman and Cremin', 'fraud_Ziemann-Waters', 'fraud_Zieme, Bode and Dooley', 'fraud_Zulauf LLC']

# category_list = ['entertainment', 'food_dining', 'gas_transport', 'grocery_net', 'grocery_pos', 'health_fitness', 'home', 'kids_pets', 'misc_net', 'misc_pos', 'personal_care', 'shopping_net', 'shopping_pos', 'travel']

# job_list = ['Academic librarian', 'Accountant, chartered certified', 'Accountant, chartered public finance', 'Accounting technician', 'Acupuncturist', 'Administrator', 'Administrator, arts', 'Administrator, charities/voluntary organisations', 'Administrator, education', 'Administrator, local government', 'Advertising account executive', 'Advertising account planner', 'Advertising copywriter', 'Advice worker', 'Aeronautical engineer', 'Agricultural consultant', 'Aid worker', 'Air broker', 'Air cabin crew', 'Airline pilot', 'Ambulance person', 'Amenity horticulturist', 'Analytical chemist', 'Animal nutritionist', 'Animal technologist', 'Animator', 'Applications developer', 'Arboriculturist', 'Archaeologist', 'Architect', 'Architectural technologist', 'Archivist', 'Armed forces logistics/support/administrative officer', 'Armed forces training and education officer', 'Art gallery manager', 'Art therapist', 'Artist', 'Arts development officer', 'Associate Professor', 'Audiological scientist', 'Barista', 'Barrister', "Barrister's clerk", 'Biochemist, clinical', 'Biomedical engineer', 'Biomedical scientist', 'Bookseller', 'Broadcast engineer', 'Broadcast presenter', 'Building control surveyor', 'Building services engineer', 'Building surveyor', 'Buyer, industrial', 'Buyer, retail', 'Cabin crew', 'Call centre manager', 'Camera operator', 'Careers information officer', 'Cartographer', 'Catering manager', 'Ceramics designer', 'Charity fundraiser', 'Charity officer', 'Chartered accountant', 'Chartered legal executive (England and Wales)', 'Chartered loss adjuster', 'Chartered public finance accountant', 'Chemical engineer', 'Chemist, analytical', 'Chief Executive Officer', 'Chief Financial Officer', 'Chief Marketing Officer', 'Chief Operating Officer', 'Chief Strategy Officer', 'Chief Technology Officer', 'Chief of Staff', 'Child psychotherapist', 'Chiropodist', 'Civil Service administrator', 'Civil Service fast streamer', 'Civil engineer, contracting', 'Claims inspector/assessor', 'Clinical biochemist', 'Clinical cytogeneticist', 'Clinical psychologist', 'Clinical research associate', 'Clothing/textile technologist', 'Colour technologist', 'Commercial horticulturist', 'Commercial/residential surveyor', 'Commissioning editor', 'Communications engineer', 'Community arts worker', 'Community development worker', 'Community education officer', 'Community pharmacist', 'Company secretary', 'Comptroller', 'Conservation officer, historic buildings', 'Conservator, furniture', 'Conservator, museum/gallery', 'Contractor', 'Control and instrumentation engineer', 'Copy', 'Copywriter, advertising', 'Corporate investment banker', 'Counselling psychologist', 'Counsellor', 'Curator', 'Cytogeneticist', 'Dance movement psychotherapist', 'Data scientist', 'Database administrator', 'Dealer', 'Designer, ceramics/pottery', 'Designer, exhibition/display', 'Designer, furniture', 'Designer, industrial/product', 'Designer, interior/spatial', 'Designer, jewellery', 'Designer, multimedia', 'Designer, television/film set', 'Designer, textile', 'Development worker, community', 'Development worker, international aid', 'Diagnostic radiographer', 'Dispensing optician', 'Doctor, general practice', 'Doctor, hospital', 'Drilling engineer', 'Early years teacher', 'Ecologist', 'Economist', 'Editor, commissioning', 'Editor, film/video', 'Editor, magazine features', 'Education administrator', 'Education officer, community', 'Education officer, museum', 'Educational psychologist', 'Electrical engineer', 'Electronics engineer', 'Embryologist, clinical', 'Emergency planning/management officer', 'Energy engineer', 'Energy manager', 'Engineer, aeronautical', 'Engineer, agricultural', 'Engineer, automotive', 'Engineer, biomedical', 'Engineer, broadcasting (operations)', 'Engineer, building services', 'Engineer, civil (consulting)', 'Engineer, civil (contracting)', 'Engineer, communications', 'Engineer, control and instrumentation', 'Engineer, drilling', 'Engineer, electronics', 'Engineer, land', 'Engineer, maintenance', 'Engineer, manufacturing', 'Engineer, materials', 'Engineer, mining', 'Engineer, petroleum', 'Engineer, production', 'Engineer, structural', 'Engineer, technical sales', 'Engineer, water', 'Engineering geologist', 'English as a foreign language teacher', 'English as a second language teacher', 'Environmental consultant', 'Environmental education officer', 'Environmental health practitioner', 'Environmental manager', 'Equality and diversity officer', 'Equities trader', 'Estate manager/land agent', 'Event organiser', 'Exercise physiologist', 'Exhibition designer', 'Exhibitions officer, museum/gallery', 'Facilities manager', 'Farm manager', 'Field seismologist', 'Field trials officer', 'Film/video editor', 'Financial adviser', 'Financial trader', 'Fine artist', 'Firefighter', 'Fisheries officer', 'Fitness centre manager', 'Forensic psychologist', 'Freight forwarder', 'Furniture conservator/restorer', 'Furniture designer', 'Further education lecturer', 'Futures trader', 'Gaffer', 'Garment/textile technologist', 'General practice doctor', 'Geneticist, molecular', 'Geochemist', 'Geologist, engineering', 'Geologist, wellsite', 'Geophysicist/field seismologist', 'Geoscientist', 'Glass blower/designer', 'Health and safety adviser', 'Health physicist', 'Health promotion specialist', 'Health service manager', 'Health visitor', 'Herbalist', 'Heritage manager', 'Herpetologist', 'Higher education careers adviser', 'Historic buildings inspector/conservation officer', 'Horticultural consultant', 'Horticultural therapist', 'Horticulturist, commercial', 'Hospital doctor', 'Hospital pharmacist', 'Hotel manager', 'Human resources officer', 'Hydrogeologist', 'Hydrographic surveyor', 'Hydrologist', 'IT consultant', 'IT trainer', 'Illustrator', 'Immigration officer', 'Immunologist', 'Industrial/product designer', 'Information systems manager', 'Insurance broker', 'Insurance claims handler', 'Insurance risk surveyor', 'Insurance underwriter', 'Intelligence analyst', 'Interior and spatial designer', 'Interpreter', 'Investment analyst', 'Investment banker, corporate', 'Investment banker, operational', 'Jewellery designer', 'Journalist, newspaper', 'Land', 'Land/geomatics surveyor', 'Landscape architect', 'Lawyer', 'Learning disability nurse', 'Learning mentor', 'Lecturer, further education', 'Lecturer, higher education', 'Leisure centre manager', 'Lexicographer', 'Librarian, academic', 'Librarian, public', 'Licensed conveyancer', 'Local government officer', 'Location manager', 'Logistics and distribution manager', 'Loss adjuster, chartered', 'Magazine features editor', 'Magazine journalist', 'Maintenance engineer', 'Make', 'Management consultant', 'Manufacturing engineer', 'Manufacturing systems engineer', 'Market researcher', 'Marketing executive', 'Materials engineer', 'Mechanical engineer', 'Media buyer', 'Media planner', 'Medical physicist', 'Medical sales representative', 'Medical secretary', 'Medical technical officer', 'Mental health nurse', 'Merchandiser, retail', 'Metallurgist', 'Minerals surveyor', 'Mining engineer', 'Mudlogger', 'Multimedia programmer', 'Museum education officer', 'Museum/gallery conservator', 'Museum/gallery exhibitions officer', 'Music therapist', 'Music tutor', 'Musician', 'Nature conservation officer', 'Naval architect', 'Network engineer', 'Neurosurgeon', "Nurse, children's", 'Nurse, mental health', 'Nutritional therapist', 'Occupational hygienist', 'Occupational psychologist', 'Occupational therapist', 'Oceanographer', 'Oncologist', 'Operational investment banker', 'Operational researcher', 'Operations geologist', 'Optician, dispensing', 'Optometrist', 'Orthoptist', 'Osteopath', 'Outdoor activities/education manager', 'Paediatric nurse', 'Paramedic', 'Patent attorney', 'Pathologist', 'Pension scheme manager', 'Pensions consultant', 'Petroleum engineer', 'Pharmacist, community', 'Pharmacist, hospital', 'Pharmacologist', 'Physicist, medical', 'Physiological scientist', 'Physiotherapist', 'Phytotherapist', 'Pilot, airline', 'Planning and development surveyor', 'Plant breeder/geneticist', 'Podiatrist', 'Police officer', "Politician's assistant", 'Presenter, broadcasting', 'Press photographer', 'Press sub', 'Primary school teacher', 'Prison officer', 'Private music teacher', 'Probation officer', 'Producer, radio', 'Producer, television/film/video', 'Product designer', 'Product manager', 'Product/process development scientist', 'Production assistant, radio', 'Production assistant, television', 'Production engineer', 'Production manager', 'Professor Emeritus', 'Programme researcher, broadcasting/film/video', 'Programmer, applications', 'Programmer, multimedia', 'Psychiatric nurse', 'Psychiatrist', 'Psychologist, clinical', 'Psychologist, counselling', 'Psychologist, forensic', 'Psychologist, sport and exercise', 'Psychotherapist', 'Psychotherapist, child', 'Public affairs consultant', 'Public house manager', 'Public librarian', 'Public relations account executive', 'Public relations officer', 'Purchasing manager', 'Quantity surveyor', 'Quarry manager', 'Race relations officer', 'Radio broadcast assistant', 'Radio producer', 'Radiographer, diagnostic', 'Radiographer, therapeutic', 'Records manager', 'Regulatory affairs officer', 'Research officer, political party', 'Research officer, trade union', 'Research scientist (life sciences)', 'Research scientist (maths)', 'Research scientist (medical)', 'Research scientist (physical sciences)', 'Restaurant manager, fast food', 'Retail banker', 'Retail buyer', 'Retail manager', 'Retail merchandiser', 'Risk analyst', 'Rural practice surveyor', 'Sales executive', 'Sales professional, IT', 'Science writer', 'Scientific laboratory technician', 'Scientist, audiological', 'Scientist, biomedical', 'Scientist, clinical (histocompatibility and immunogenetics)', 'Scientist, marine', 'Scientist, physiological', 'Scientist, research (maths)', 'Scientist, research (medical)', 'Scientist, research (physical sciences)', 'Secondary school teacher', 'Secretary/administrator', 'Seismic interpreter', 'Senior tax professional/tax inspector', 'Set designer', 'Site engineer', 'Social research officer, government', 'Social researcher', 'Software engineer', 'Soil scientist', 'Solicitor, Scotland', 'Special educational needs teacher', 'Special effects artist', 'Sport and exercise psychologist', 'Sports administrator', 'Sports development officer', 'Stage manager', 'Statistician', 'Structural engineer', 'Sub', 'Surgeon', 'Surveyor, hydrographic', 'Surveyor, land/geomatics', 'Surveyor, minerals', 'Surveyor, mining', 'Surveyor, rural practice', 'Systems analyst', 'Systems developer', 'TEFL teacher', 'Tax adviser', 'Tax inspector', 'Teacher, English as a foreign language', 'Teacher, adult education', 'Teacher, early years/pre', 'Teacher, primary school', 'Teacher, secondary school', 'Teacher, special educational needs', 'Teaching laboratory technician', 'Technical brewer', 'Telecommunications researcher', 'Television camera operator', 'Television floor manager', 'Television production assistant', 'Television/film/video producer', 'Textile designer', 'Theatre director', 'Theatre manager', 'Theme park manager', 'Therapist, art', 'Therapist, drama', 'Therapist, horticultural', 'Therapist, music', 'Therapist, occupational', 'Therapist, sports', 'Tour manager', 'Tourism officer', 'Tourist information centre manager', 'Town planner', 'Toxicologist', 'Trade mark attorney', 'Trading standards officer', 'Training and development officer', 'Transport planner', 'Travel agency manager', 'Tree surgeon', 'Video editor', 'Visual merchandiser', 'Volunteer coordinator', 'Warden/ranger', 'Waste management officer', 'Water engineer', 'Water quality scientist', 'Web designer', 'Wellsite geologist', 'Writer']

# # === Load data & components ===
# artifacts = load_model_artifacts()
# # df = load_dataset()

# models = artifacts["models"]
# scaler = artifacts["scaler"]
# features = artifacts["features"]

# # === UI Title ===
# st.title("üí≥ Credit Card Fraud Detection")

# # === Sidebar inputs ===
# st.sidebar.header("üìã Transaction Input")

# merchant_code = pd.Series(sorted(merchant_list), dtype="category").cat.set_categories(merchant_list).cat.codes[0]
# category_code = pd.Series(sorted(category_list), dtype="category").cat.set_categories(category_list).cat.codes[0]
# job_code = pd.Series(sorted(job_list), dtype="category").cat.set_categories(job_list).cat.codes[0]
# # Input Fields
# merchant_input = st.sidebar.selectbox("üõí Merchant", merchant_list, key="merchant")
# category_input = st.sidebar.selectbox("üì¶ Category", category_list, key="category")
# job_input = st.sidebar.selectbox("üë®‚Äçüíº Customer Job", job_list, key="job")
# amount_input = st.sidebar.slider("üí∞ Transaction Amount ($)", 0.0, 5000.0, 100.0, step=10.0, key="amount")
# selected_model = st.sidebar.selectbox("‚öôÔ∏è Select Model", list(models.keys()), key="model")

# # === Prediction Trigger ===
# if "predict" not in st.session_state:
#     st.session_state["predict"] = False

# # Run prediction on button click
# if st.sidebar.button("üö® Detect Fraud"):
#     st.session_state["predict"] = True

# # === Prediction Section (only if triggered) ===
# if st.session_state["predict"]:
#     try:
#         # Encode input values
#         merchant_code = pd.Series([merchant_input], dtype="category").cat.set_categories(merchant_list).cat.codes[0]
#         category_code = pd.Series([category_input], dtype="category").cat.set_categories(category_list).cat.codes[0]
#         job_code = pd.Series([job_input], dtype="category").cat.set_categories(job_list).cat.codes[0]

#         scaled_amt = scaler.transform([[amount_input]])[0][0]

#         input_data = {
#             "merchant": merchant_code,
#             "category": category_code,
#             "job": job_code,
#             "scaled_amt": scaled_amt
#         }

#         for col in features:
#             if col not in input_data:
#                 input_data[col] = 0

#         input_df = pd.DataFrame([input_data])[features]

#         model = models[selected_model]
#         fraud_proba = model.predict_proba(input_df)[0][1]

#         # === Show Result ===
#         st.subheader("üîé Prediction Result")
#         st.success(f"Model Used: **{selected_model}**")
#         st.metric("Fraud Probability", f"{fraud_proba * 100:.2f}%")

#     except Exception as e:
#         st.error(f"‚ùå Error during prediction: {e}")

#     # Reset trigger (optional)
#     st.session_state["predict"] = False








import streamlit as st
import pandas as pd
import joblib
import numpy as np

# === Set page config (this MUST come early) ===
st.set_page_config(page_title="Fraud Detection App", layout="centered")

import os

# Use absolute safe path for loading models
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
MODEL_PATH = os.path.join(BASE_DIR, "models", "xgboost.pkl")
SCALER_PATH = os.path.join(BASE_DIR, "models", "scaler.pkl")
FEATURES_PATH = os.path.join(BASE_DIR, "models", "feature_columns.pkl")
LGISTIC_REGRESSION_PATH = os.path.join(BASE_DIR, "models", "logistic_regression.pkl")
RANDOM_FOREST_PATH = os.path.join(BASE_DIR, "models", "random_forest.pkl")
NGBOOST_PATH = os.path.join(BASE_DIR, "models", "xgboost.pkl")


# === Load Model Artifacts ===
# @st.cache_data
# def load_artifacts():
#     return {
#         "models": {
#             "Logistic Regression": joblib.load(LGISTIC_REGRESSION_PATH),
#             "Random Forest": joblib.load(RANDOM_FOREST_PATH),
#             "XGBoost": joblib.load(NGBOOST_PATH)
#         },
#         "scaler": joblib.load(SCALER_PATH),
#         "features": joblib.load(FEATURES_PATH),
#         # "merchant_list": joblib.load("models/merchant_list.pkl"),
#         # "category_list": joblib.load("models/category_list.pkl"),
#         # "job_list": joblib.load("models/job_list.pkl")
#     }

@st.cache_resource
def load_artifacts():
    models = joblib.load("models/xgboost.pkl")
    scaler = joblib.load("models/scaler.pkl")
    feature_columns = joblib.load("models/feature_columns.pkl")
    return model, scaler, feature_columns


merchant_list = ['fraud_Abbott-Rogahn', 'fraud_Abbott-Steuber', 'fraud_Abernathy and Sons', 'fraud_Abshire PLC', 'fraud_Adams, Kovacek and Kuhlman', 'fraud_Adams-Barrows', 'fraud_Altenwerth, Cartwright and Koss', 'fraud_Altenwerth-Kilback', 'fraud_Ankunding LLC', 'fraud_Ankunding-Carroll', 'fraud_Armstrong, Walter and Gottlieb', 'fraud_Auer LLC', 'fraud_Auer-Mosciski', 'fraud_Auer-West', 'fraud_Bahringer Group', 'fraud_Bahringer, Bergnaum and Quitzon', 'fraud_Bahringer, Osinski and Block', 'fraud_Bahringer, Schoen and Corkery', 'fraud_Bahringer-Larson', 'fraud_Bahringer-Streich', 'fraud_Bailey-Morar', 'fraud_Balistreri-Nader', 'fraud_Barrows PLC', 'fraud_Bartoletti and Sons', 'fraud_Bartoletti-Wunsch', 'fraud_Barton Inc', 'fraud_Barton LLC', 'fraud_Bashirian Group', 'fraud_Bauch-Blanda', 'fraud_Bauch-Raynor', 'fraud_Baumbach Ltd', 'fraud_Baumbach, Feeney and Morar', 'fraud_Baumbach, Hodkiewicz and Walsh', 'fraud_Baumbach, Strosin and Nicolas', 'fraud_Bechtelar-Rippin', 'fraud_Becker, Harris and Harvey', 'fraud_Bednar Group', 'fraud_Bednar Inc', 'fraud_Bednar PLC', 'fraud_Beer-Jast', 'fraud_Beier LLC', 'fraud_Beier and Sons', 'fraud_Beier-Hyatt', 'fraud_Berge LLC', 'fraud_Berge, Kautzer and Harris', 'fraud_Berge-Hills', 'fraud_Berge-Ullrich', 'fraud_Bernhard Inc', 'fraud_Bernhard, Grant and Langworth', 'fraud_Bernhard-Lesch', 'fraud_Bernier and Sons', 'fraud_Bernier, Streich and Jewess', 'fraud_Bernier, Volkman and Hoeger', 'fraud_Bins, Balistreri and Beatty', 'fraud_Bins-Howell', 'fraud_Bins-Rice', 'fraud_Bins-Tillman', 'fraud_Block Group', 'fraud_Block-Hauck', 'fraud_Block-Parisian', 'fraud_Bode-Rempel', 'fraud_Bode-Schuster', 'fraud_Boehm, Block and Jakubowski', 'fraud_Boehm, Predovic and Reinger', 'fraud_Bogisich Inc', 'fraud_Bogisich-Homenick', 'fraud_Bogisich-Weimann', 'fraud_Botsford Ltd', 'fraud_Botsford PLC', 'fraud_Botsford and Sons', 'fraud_Boyer PLC', 'fraud_Boyer-Haley', 'fraud_Boyer-Reichert', 'fraud_Bradtke PLC', 'fraud_Bradtke, Torp and Bahringer', 'fraud_Breitenberg LLC', 'fraud_Breitenberg-Hermiston', 'fraud_Brekke and Sons', 'fraud_Brown Inc', 'fraud_Brown PLC', 'fraud_Brown, Homenick and Lesch', 'fraud_Brown-Greenholt', 'fraud_Bruen-Yost', 'fraud_Buckridge PLC', 'fraud_Carroll PLC', 'fraud_Cartwright PLC', 'fraud_Cartwright-Harris', 'fraud_Casper, Hand and Zulauf', 'fraud_Cassin-Harvey', 'fraud_Champlin and Sons', 'fraud_Champlin, Rolfson and Connelly', 'fraud_Champlin-Casper', 'fraud_Christiansen, Goyette and Schamberger', 'fraud_Christiansen-Gusikowski', 'fraud_Cole PLC', 'fraud_Cole, Hills and Jewess', 'fraud_Collier Inc', 'fraud_Collier LLC', 'fraud_Connelly PLC', 'fraud_Connelly, Reichert and Fritsch', 'fraud_Connelly-Carter', 'fraud_Conroy Ltd', 'fraud_Conroy, Balistreri and Gorczany', 'fraud_Conroy-Cruickshank', 'fraud_Conroy-Emard', 'fraud_Cormier LLC', 'fraud_Cormier, Stracke and Thiel', 'fraud_Corwin-Collins', 'fraud_Corwin-Gorczany', 'fraud_Corwin-Romaguera', 'fraud_Cremin, Hamill and Reichel', 'fraud_Crist, Jakubowski and Littel', 'fraud_Crona and Sons', 'fraud_Cronin, Kshlerin and Weber', 'fraud_Crooks and Sons', 'fraud_Cruickshank-Mills', 'fraud_Cummerata-Hilpert', 'fraud_Cummerata-Jones', 'fraud_Cummings Group', 'fraud_Cummings LLC', 'fraud_Dach-Borer', 'fraud_Dach-Nader', 'fraud_Dare, Casper and Bartoletti', 'fraud_Dare, Fritsch and Zboncak', 'fraud_Dare-Gibson', 'fraud_Dare-Marvin', 'fraud_Daugherty LLC', 'fraud_Daugherty, Pouros and Beahan', 'fraud_Daugherty-Thompson', 'fraud_Deckow-Dare', "fraud_Deckow-O'Conner", 'fraud_Denesik and Sons', 'fraud_Denesik, Powlowski and Pouros', 'fraud_Dibbert and Sons', 'fraud_Dibbert-Green', 'fraud_Dicki Ltd', 'fraud_Dickinson Ltd', 'fraud_Dickinson-Rempel', 'fraud_Dietrich-Fadel', 'fraud_Donnelly LLC', 'fraud_Donnelly PLC', 'fraud_Dooley Inc', 'fraud_Dooley-Thompson', 'fraud_Douglas, DuBuque and McKenzie', 'fraud_Douglas, Schneider and Turner', 'fraud_Douglas-White', 'fraud_Doyle Ltd', 'fraud_DuBuque LLC', 'fraud_Durgan, Gislason and Spencer', 'fraud_Durgan-Auer', 'fraud_Ebert-Daugherty', 'fraud_Effertz LLC', 'fraud_Effertz, Welch and Schowalter', 'fraud_Eichmann, Bogan and Rodriguez', 'fraud_Eichmann, Hayes and Treutel', 'fraud_Eichmann-Kilback', 'fraud_Eichmann-Russel', 'fraud_Emard Inc', 'fraud_Emmerich-Luettgen', 'fraud_Emmerich-Rau', 'fraud_Erdman-Durgan', 'fraud_Erdman-Ebert', 'fraud_Erdman-Kertzmann', 'fraud_Erdman-Schaden', 'fraud_Ernser-Feest', 'fraud_Ernser-Lynch', 'fraud_Fadel Inc', 'fraud_Fadel, Mertz and Rippin', 'fraud_Fadel-Hilpert', 'fraud_Fahey Inc', 'fraud_Feil, Hilpert and Koss', 'fraud_Feil-Morar', 'fraud_Ferry, Lynch and Kautzer', 'fraud_Ferry, Reichel and DuBuque', 'fraud_Fisher Inc', 'fraud_Fisher-Schowalter', 'fraud_Flatley Group', 'fraud_Flatley-Durgan', 'fraud_Frami Group', 'fraud_Friesen Inc', 'fraud_Friesen Ltd', "fraud_Friesen-D'Amore", 'fraud_Friesen-Ortiz', 'fraud_Friesen-Stamm', 'fraud_Fritsch LLC', 'fraud_Fritsch and Sons', 'fraud_Funk Group', 'fraud_Gaylord-Powlowski', 'fraud_Gerhold LLC', 'fraud_Gerlach Inc', 'fraud_Gibson-Deckow', 'fraud_Gislason Group', 'fraud_Gleason and Sons', 'fraud_Gleason-Macejkovic', 'fraud_Goldner, Kovacek and Abbott', 'fraud_Goldner-Lemke', 'fraud_Goodwin-Nitzsche', 'fraud_Gottlieb Group', 'fraud_Gottlieb, Considine and Schultz', 'fraud_Gottlieb-Hansen', 'fraud_Goyette Inc', 'fraud_Goyette, Howell and Collier', 'fraud_Goyette-Gerhold', 'fraud_Goyette-Herzog', 'fraud_Graham and Sons', 'fraud_Graham, Hegmann and Hammes', 'fraud_Greenfelder, Bartoletti and Davis', 'fraud_Greenholt Ltd', 'fraud_Greenholt, Jacobi and Gleason', "fraud_Greenholt, O'Hara and Balistreri", 'fraud_Grimes LLC', 'fraud_Gulgowski LLC', 'fraud_Gutmann Ltd', 'fraud_Gutmann, McLaughlin and Wiza', 'fraud_Gutmann-Upton', 'fraud_Haag-Blanda', 'fraud_Hackett Group', 'fraud_Hackett-Lueilwitz', 'fraud_Hagenes, Hermann and Stroman', 'fraud_Hagenes, Kohler and Hoppe', 'fraud_Hahn, Bahringer and McLaughlin', 'fraud_Hahn, Douglas and Schowalter', 'fraud_Haley Group', 'fraud_Haley, Batz and Auer', 'fraud_Haley, Jewess and Bechtelar', 'fraud_Halvorson Group', "fraud_Hamill-D'Amore", 'fraud_Hamill-Daugherty', 'fraud_Hammes-Beatty', 'fraud_Harber Inc', 'fraud_Harris Group', 'fraud_Harris Inc', 'fraud_Harris, Gusikowski and Heaney', 'fraud_Hartmann, Rowe and Hermann', 'fraud_Hauck, Dietrich and Funk', 'fraud_Hayes, Marquardt and Dibbert', 'fraud_Heaney-Marquardt', 'fraud_Heathcote LLC', 'fraud_Heathcote, Yost and Kertzmann', 'fraud_Heidenreich PLC', 'fraud_Heller PLC', 'fraud_Heller, Gutmann and Zieme', 'fraud_Heller-Abshire', 'fraud_Heller-Langosh', 'fraud_Herman Inc', 'fraud_Herman, Treutel and Dickens', 'fraud_Hermann and Sons', 'fraud_Hermann-Gaylord', 'fraud_Hermiston, Pacocha and Smith', 'fraud_Hermiston, Russel and Price', 'fraud_Herzog Ltd', 'fraud_Hettinger, McCullough and Fay', 'fraud_Hickle Group', 'fraud_Hills, Hegmann and Schaefer', 'fraud_Hills-Boyer', 'fraud_Hills-Olson', 'fraud_Hills-Witting', 'fraud_Hilpert-Conroy', 'fraud_Hintz, Bauch and Smith', 'fraud_Hintz-Bruen', 'fraud_Hirthe-Beier', 'fraud_Hodkiewicz, Prohaska and Paucek', 'fraud_Homenick LLC', 'fraud_Hoppe, Harris and Bednar', 'fraud_Hoppe-Parisian', 'fraud_Howe Ltd', 'fraud_Howe PLC', 'fraud_Hudson-Grady', 'fraud_Hudson-Ratke', 'fraud_Huel Ltd', 'fraud_Huel, Hammes and Witting', 'fraud_Huel-Langworth', 'fraud_Huels-Hahn', 'fraud_Huels-Nolan', 'fraud_Hyatt, Russel and Gleichner', 'fraud_Hyatt-Blick', 'fraud_Jacobi Inc', 'fraud_Jacobi and Sons', 'fraud_Jakubowski Group', 'fraud_Jakubowski Inc', 'fraud_Jaskolski-Dibbert', 'fraud_Jaskolski-Vandervort', 'fraud_Jast Ltd', 'fraud_Jast and Sons', 'fraud_Jast-McDermott', 'fraud_Jenkins, Hauck and Friesen', 'fraud_Jerde-Hermann', 'fraud_Jewess LLC', 'fraud_Johns Inc', 'fraud_Johns-Hoeger', 'fraud_Johnson, Runolfsdottir and Mayer', 'fraud_Johnston, Nikolaus and Maggio', 'fraud_Johnston-Casper', 'fraud_Jones, Sawayn and Romaguera', 'fraud_Kassulke Inc', 'fraud_Kassulke PLC', 'fraud_Kautzer and Sons', 'fraud_Keeling-Crist', 'fraud_Kemmer-Buckridge', 'fraud_Kemmer-Reinger', 'fraud_Kerluke Inc', 'fraud_Kerluke PLC', 'fraud_Kerluke, Considine and Macejkovic', 'fraud_Kerluke, Kertzmann and Wiza', 'fraud_Kerluke-Abshire', 'fraud_Kertzmann LLC', 'fraud_Kessler Group', 'fraud_Kessler Inc', 'fraud_Kiehn Inc', 'fraud_Kiehn-Emmerich', 'fraud_Kihn Inc', 'fraud_Kihn, Abernathy and Douglas', 'fraud_Kihn, Brakus and Goyette', 'fraud_Kihn-Fritsch', 'fraud_Kihn-Schuster', 'fraud_Kilback Group', 'fraud_Kilback LLC', 'fraud_Kilback and Sons', 'fraud_Kilback, Nitzsche and Leffler', 'fraud_Kirlin and Sons', 'fraud_Klein Group', 'fraud_Kling Inc', 'fraud_Kling, Howe and Schneider', 'fraud_Kling-Ernser', 'fraud_Kling-Grant', 'fraud_Klocko LLC', 'fraud_Klocko, Runolfsdottir and Breitenberg', 'fraud_Koelpin and Sons', 'fraud_Koepp-Parker', 'fraud_Koepp-Witting', 'fraud_Kohler, Lindgren and Koelpin', 'fraud_Konopelski, Schneider and Hartmann', 'fraud_Koss and Sons', 'fraud_Koss, Hansen and Lueilwitz', 'fraud_Koss, McLaughlin and Mayer', 'fraud_Kovacek Ltd', 'fraud_Kovacek, Dibbert and Ondricka', 'fraud_Kozey-Boehm', 'fraud_Kozey-Kuhlman', 'fraud_Kozey-McDermott', 'fraud_Kris-Kertzmann', 'fraud_Kris-Padberg', 'fraud_Kris-Weimann', 'fraud_Kub PLC', 'fraud_Kub-Heaney', 'fraud_Kuhic Inc', 'fraud_Kuhic LLC', 'fraud_Kuhic, Bins and Pfeffer', 'fraud_Kuhn Group', 'fraud_Kuhn LLC', 'fraud_Kulas Group', 'fraud_Kunde-Sanford', 'fraud_Kunze Inc', 'fraud_Kunze, Larkin and Mayert', 'fraud_Kuphal-Bartoletti', 'fraud_Kuphal-Predovic', 'fraud_Kuphal-Toy', 'fraud_Kutch Group', 'fraud_Kutch LLC', 'fraud_Kutch and Sons', 'fraud_Kutch, Hermiston and Farrell', 'fraud_Kutch, Steuber and Gerhold', 'fraud_Kutch-Ferry', 'fraud_Kutch-Hegmann', 'fraud_Kutch-Wilderman', 'fraud_Kuvalis Ltd', 'fraud_Labadie LLC', 'fraud_Labadie, Treutel and Bode', 'fraud_Lakin, Ferry and Beatty', 'fraud_Lang, Towne and Schuppe', 'fraud_Langosh, Wintheiser and Hyatt', 'fraud_Langworth LLC', 'fraud_Langworth, Boehm and Gulgowski', 'fraud_Larkin Ltd', 'fraud_Larkin, Stracke and Greenfelder', 'fraud_Larson, Quitzon and Spencer', 'fraud_Larson-Moen', 'fraud_Leannon-Nikolaus', 'fraud_Leannon-Ward', 'fraud_Lebsack and Sons', 'fraud_Ledner, Hartmann and Feest', 'fraud_Ledner-Pfannerstill', 'fraud_Leffler-Goldner', 'fraud_Lehner, Mosciski and King', 'fraud_Lehner, Reichert and Mills', 'fraud_Lemke and Sons', 'fraud_Lemke-Gutmann', 'fraud_Lesch Ltd', "fraud_Lesch, D'Amore and Brown", 'fraud_Lind, Huel and McClure', 'fraud_Lind-Buckridge', 'fraud_Little Ltd', 'fraud_Little, Gutmann and Lynch', 'fraud_Little-Gleichner', 'fraud_Lockman Ltd', 'fraud_Lockman, West and Runte', 'fraud_Lowe, Dietrich and Erdman', 'fraud_Lubowitz, Terry and Stracke', 'fraud_Lubowitz-Walter', 'fraud_Luettgen PLC', 'fraud_Lynch Ltd', 'fraud_Lynch-Mohr', 'fraud_Lynch-Wisozk', 'fraud_Macejkovic-Lesch', 'fraud_Maggio-Fahey', 'fraud_Mante Group', 'fraud_Mante, Luettgen and Hackett', 'fraud_Marks Inc', 'fraud_Marvin-Lind', 'fraud_Mayert Group', 'fraud_McCullough Group', 'fraud_McCullough LLC', 'fraud_McCullough, Hudson and Schuster', 'fraud_McDermott, Osinski and Morar', 'fraud_McDermott-Rice', 'fraud_McDermott-Weimann', 'fraud_McGlynn-Heathcote', 'fraud_McGlynn-Jaskolski', 'fraud_McKenzie-Huels', 'fraud_McLaughlin, Armstrong and Koepp', 'fraud_Medhurst Inc', 'fraud_Medhurst PLC', 'fraud_Medhurst, Cartwright and Ebert', 'fraud_Medhurst, Labadie and Gottlieb', 'fraud_Metz, Russel and Metz', 'fraud_Metz-Boehm', 'fraud_Miller-Harris', 'fraud_Miller-Hauck', 'fraud_Moen, Reinger and Murphy', 'fraud_Mohr Inc', 'fraud_Mohr-Bayer', 'fraud_Monahan, Bogisich and Ledner', 'fraud_Monahan, Hermann and Johns', 'fraud_Monahan-Morar', 'fraud_Moore, Dibbert and Koepp', 'fraud_Moore, Williamson and Emmerich', 'fraud_Morar Inc', 'fraud_Morissette LLC', 'fraud_Morissette PLC', 'fraud_Morissette, Weber and Wiegand', 'fraud_Morissette-Schaefer', 'fraud_Mosciski Group', 'fraud_Mosciski, Gislason and Mertz', 'fraud_Mosciski, Ziemann and Farrell', 'fraud_Mraz-Herzog', 'fraud_Mueller, Gerhold and Mueller', 'fraud_Murray Ltd', 'fraud_Murray-Smitham', 'fraud_Nader-Heller', 'fraud_Nader-Maggio', 'fraud_Nicolas, Hills and McGlynn', 'fraud_Nienow PLC', 'fraud_Nienow, Ankunding and Collier', 'fraud_Nienow, Barrows and Romaguera', 'fraud_Nitzsche, Kessler and Wolff', 'fraud_Nolan-Williamson', "fraud_O'Connell, Botsford and Hand", "fraud_O'Connell-Ullrich", "fraud_O'Hara-Wilderman", "fraud_O'Keefe-Hudson", "fraud_O'Keefe-Wisoky", "fraud_O'Reilly, Mohr and Purdy", 'fraud_Okuneva, Schneider and Rau', 'fraud_Olson, Becker and Koch', 'fraud_Ortiz Group', 'fraud_Osinski Inc', 'fraud_Osinski, Ledner and Leuschke', 'fraud_Pacocha-Bauch', "fraud_Pacocha-O'Reilly", 'fraud_Pacocha-Weissnat', 'fraud_Padberg-Rogahn', 'fraud_Padberg-Sauer', 'fraud_Padberg-Welch', 'fraud_Pagac LLC', 'fraud_Parisian and Sons', 'fraud_Parisian, Schiller and Altenwerth', 'fraud_Parker, Nolan and Trantow', 'fraud_Parker-Kunde', 'fraud_Paucek-Wiza', 'fraud_Pfeffer LLC', 'fraud_Pfeffer and Sons', 'fraud_Pollich LLC', 'fraud_Pouros, Walker and Spencer', 'fraud_Pouros-Conroy', 'fraud_Pouros-Haag', 'fraud_Powlowski-Weimann', 'fraud_Predovic Inc', 'fraud_Price Inc', 'fraud_Prohaska-Murray', 'fraud_Prosacco LLC', 'fraud_Prosacco, Kreiger and Kovacek', 'fraud_Quitzon, Green and Bashirian', 'fraud_Quitzon-Goyette', 'fraud_Ratke and Sons', 'fraud_Rau and Sons', 'fraud_Rau-Grant', 'fraud_Rau-Robel', 'fraud_Raynor, Feest and Miller', 'fraud_Raynor, Reinger and Hagenes', 'fraud_Reichel Inc', 'fraud_Reichel LLC', 'fraud_Reichel, Bradtke and Blanda', 'fraud_Reichert, Huels and Hoppe', 'fraud_Reichert, Rowe and Mraz', 'fraud_Reichert, Shanahan and Hayes', 'fraud_Reichert-Weissnat', 'fraud_Reilly LLC', 'fraud_Reilly and Sons', 'fraud_Reilly, Heaney and Cole', 'fraud_Reinger, Weissnat and Strosin', 'fraud_Rempel Inc', 'fraud_Rempel PLC', 'fraud_Renner Ltd', 'fraud_Reynolds-Schinner', 'fraud_Rippin, Kub and Mann', 'fraud_Rippin-VonRueden', 'fraud_Ritchie, Bradtke and Stiedemann', 'fraud_Ritchie, Oberbrunner and Cremin', 'fraud_Robel, Cummerata and Prosacco', 'fraud_Roberts, Daniel and Macejkovic', 'fraud_Roberts, Ryan and Smith', 'fraud_Roberts-Beahan', 'fraud_Rodriguez Group', 'fraud_Rodriguez, Yost and Jenkins', 'fraud_Rohan, White and Aufderhar', 'fraud_Rolfson-Kunde', 'fraud_Romaguera Ltd', 'fraud_Romaguera and Sons', 'fraud_Romaguera, Cruickshank and Greenholt', 'fraud_Romaguera, Wehner and Tromp', 'fraud_Roob LLC', 'fraud_Roob, Conn and Tremblay', 'fraud_Roob-Okuneva', 'fraud_Rowe, Batz and Goodwin', 'fraud_Rowe-Vandervort', 'fraud_Ruecker Group', 'fraud_Ruecker, Beer and Collier', 'fraud_Ruecker-Mayert', 'fraud_Runolfsdottir, Mueller and Hand', 'fraud_Runolfsson and Sons', 'fraud_Runte, Green and Emard', 'fraud_Runte-Mohr', 'fraud_Rutherford, Homenick and Bergstrom', 'fraud_Rutherford-Mertz', 'fraud_Satterfield-Lowe', 'fraud_Sawayn PLC', 'fraud_Schaefer Ltd', 'fraud_Schaefer, Fay and Hilll', 'fraud_Schaefer, Maggio and Daugherty', 'fraud_Schaefer, McGlynn and Bosco', "fraud_Schamberger-O'Keefe", 'fraud_Schiller Ltd', 'fraud_Schiller, Blanda and Johnson', 'fraud_Schimmel-Olson', 'fraud_Schmeler Inc', 'fraud_Schmeler, Bashirian and Price', 'fraud_Schmeler-Howe', 'fraud_Schmidt and Sons', 'fraud_Schmidt-Larkin', 'fraud_Schmitt Inc', 'fraud_Schmitt Ltd', 'fraud_Schneider, Hayes and Nikolaus', 'fraud_Schoen Ltd', 'fraud_Schoen, Kuphal and Nitzsche', 'fraud_Schoen, Nienow and Bauch', 'fraud_Schoen-Quigley', 'fraud_Schroeder Group', 'fraud_Schroeder, Hauck and Treutel', 'fraud_Schroeder, Wolff and Hermiston', 'fraud_Schulist Ltd', 'fraud_Schultz, Simonis and Little', 'fraud_Schumm PLC', 'fraud_Schumm, Bauch and Ondricka', 'fraud_Schumm, McLaughlin and Carter', 'fraud_Schuppe LLC', 'fraud_Schuppe, Nolan and Hoeger', 'fraud_Schuppe-Schuppe', 'fraud_Shanahan-Lehner', 'fraud_Shields Inc', 'fraud_Shields-Wunsch', 'fraud_Simonis-Prohaska', 'fraud_Skiles LLC', 'fraud_Skiles-Ankunding', 'fraud_Smith-Stokes', 'fraud_Smitham-Boehm', 'fraud_Smitham-Schiller', 'fraud_Spencer PLC', 'fraud_Spencer-Runolfsson', 'fraud_Spinka Inc', 'fraud_Spinka-Welch', 'fraud_Sporer Inc', 'fraud_Sporer-Keebler', 'fraud_Stamm-Rodriguez', 'fraud_Stamm-Witting', 'fraud_Stanton, Jakubowski and Baumbach', 'fraud_Stark-Batz', 'fraud_Stark-Koss', 'fraud_Stehr, Jewess and Schimmel', 'fraud_Stiedemann Inc', 'fraud_Stiedemann Ltd', 'fraud_Stokes, Christiansen and Sipes', 'fraud_Stoltenberg-Beatty', 'fraud_Stracke-Lemke', 'fraud_Streich Ltd', 'fraud_Streich, Dietrich and Barton', 'fraud_Streich, Hansen and Veum', 'fraud_Streich, Rolfson and Wilderman', 'fraud_Stroman, Hudson and Erdman', 'fraud_Strosin-Cruickshank', 'fraud_Swaniawski, Bahringer and Ledner', 'fraud_Swaniawski, Lowe and Robel', 'fraud_Swaniawski, Nitzsche and Welch', 'fraud_Swift PLC', 'fraud_Swift, Bradtke and Marquardt', 'fraud_Terry Ltd', 'fraud_Terry, Johns and Bins', 'fraud_Terry-Huel', 'fraud_Thiel Ltd', 'fraud_Thiel PLC', 'fraud_Thiel-Thiel', 'fraud_Thompson-Gleason', 'fraud_Tillman LLC', 'fraud_Tillman, Dickinson and Labadie', 'fraud_Tillman, Fritsch and Schmitt', 'fraud_Torp, Muller and Borer', 'fraud_Torp-Labadie', 'fraud_Torp-Lemke', 'fraud_Torphy-Goyette', 'fraud_Torphy-Kertzmann', 'fraud_Towne LLC', 'fraud_Towne, Greenholt and Koepp', 'fraud_Towne, Walker and Borer', 'fraud_Trantow PLC', 'fraud_Treutel-King', 'fraud_Tromp Group', 'fraud_Tromp, Kerluke and Glover', 'fraud_Turcotte, Batz and Buckridge', 'fraud_Turcotte, McKenzie and Koss', 'fraud_Turcotte-Halvorson', 'fraud_Turner LLC', 'fraud_Turner and Sons', 'fraud_Turner, Ruecker and Parisian', 'fraud_Turner, Ziemann and Lehner', 'fraud_Ullrich Ltd', 'fraud_Upton PLC', 'fraud_Vandervort-Funk', 'fraud_Veum-Koelpin', 'fraud_Volkman Ltd', 'fraud_Volkman PLC', 'fraud_Volkman-Predovic', 'fraud_VonRueden Group', 'fraud_Waelchi Inc', 'fraud_Waelchi-Wolf', 'fraud_Walter, Hettinger and Kessler', 'fraud_Waters-Cruickshank', 'fraud_Watsica LLC', 'fraud_Watsica, Haag and Considine', 'fraud_Weber and Sons', 'fraud_Weber, Thiel and Hammes', 'fraud_Weimann, Kuhic and Beahan', 'fraud_Weimann-Lockman', 'fraud_Welch Inc', 'fraud_Welch, Rath and Koepp', 'fraud_White and Sons', 'fraud_Wiegand-Lowe', 'fraud_Wilkinson LLC', 'fraud_Wilkinson Ltd', 'fraud_Wilkinson PLC', 'fraud_Will Ltd', 'fraud_Williamson LLC', 'fraud_Willms, Kris and Bergnaum', 'fraud_Windler LLC', 'fraud_Windler, Goodwin and Kovacek', 'fraud_Wintheiser, Dietrich and Schimmel', 'fraud_Wisozk and Sons', 'fraud_Witting, Beer and Ernser', 'fraud_Wiza LLC', 'fraud_Wiza, Schaden and Stark', 'fraud_Wolf Inc', 'fraud_Wuckert, Wintheiser and Friesen', 'fraud_Wuckert-Goldner', 'fraud_Wuckert-Walter', 'fraud_Yost, Block and Koepp', 'fraud_Yost, Schamberger and Windler', 'fraud_Yost-Rogahn', 'fraud_Zboncak LLC', 'fraud_Zboncak Ltd', 'fraud_Zboncak, Rowe and Murazik', 'fraud_Zemlak Group', 'fraud_Zemlak, Tillman and Cremin', 'fraud_Ziemann-Waters', 'fraud_Zieme, Bode and Dooley', 'fraud_Zulauf LLC']

category_list = ['entertainment', 'food_dining', 'gas_transport', 'grocery_net', 'grocery_pos', 'health_fitness', 'home', 'kids_pets', 'misc_net', 'misc_pos', 'personal_care', 'shopping_net', 'shopping_pos', 'travel']

job_list = ['Academic librarian', 'Accountant, chartered certified', 'Accountant, chartered public finance', 'Accounting technician', 'Acupuncturist', 'Administrator', 'Administrator, arts', 'Administrator, charities/voluntary organisations', 'Administrator, education', 'Administrator, local government', 'Advertising account executive', 'Advertising account planner', 'Advertising copywriter', 'Advice worker', 'Aeronautical engineer', 'Agricultural consultant', 'Aid worker', 'Air broker', 'Air cabin crew', 'Airline pilot', 'Ambulance person', 'Amenity horticulturist', 'Analytical chemist', 'Animal nutritionist', 'Animal technologist', 'Animator', 'Applications developer', 'Arboriculturist', 'Archaeologist', 'Architect', 'Architectural technologist', 'Archivist', 'Armed forces logistics/support/administrative officer', 'Armed forces training and education officer', 'Art gallery manager', 'Art therapist', 'Artist', 'Arts development officer', 'Associate Professor', 'Audiological scientist', 'Barista', 'Barrister', "Barrister's clerk", 'Biochemist, clinical', 'Biomedical engineer', 'Biomedical scientist', 'Bookseller', 'Broadcast engineer', 'Broadcast presenter', 'Building control surveyor', 'Building services engineer', 'Building surveyor', 'Buyer, industrial', 'Buyer, retail', 'Cabin crew', 'Call centre manager', 'Camera operator', 'Careers information officer', 'Cartographer', 'Catering manager', 'Ceramics designer', 'Charity fundraiser', 'Charity officer', 'Chartered accountant', 'Chartered legal executive (England and Wales)', 'Chartered loss adjuster', 'Chartered public finance accountant', 'Chemical engineer', 'Chemist, analytical', 'Chief Executive Officer', 'Chief Financial Officer', 'Chief Marketing Officer', 'Chief Operating Officer', 'Chief Strategy Officer', 'Chief Technology Officer', 'Chief of Staff', 'Child psychotherapist', 'Chiropodist', 'Civil Service administrator', 'Civil Service fast streamer', 'Civil engineer, contracting', 'Claims inspector/assessor', 'Clinical biochemist', 'Clinical cytogeneticist', 'Clinical psychologist', 'Clinical research associate', 'Clothing/textile technologist', 'Colour technologist', 'Commercial horticulturist', 'Commercial/residential surveyor', 'Commissioning editor', 'Communications engineer', 'Community arts worker', 'Community development worker', 'Community education officer', 'Community pharmacist', 'Company secretary', 'Comptroller', 'Conservation officer, historic buildings', 'Conservator, furniture', 'Conservator, museum/gallery', 'Contractor', 'Control and instrumentation engineer', 'Copy', 'Copywriter, advertising', 'Corporate investment banker', 'Counselling psychologist', 'Counsellor', 'Curator', 'Cytogeneticist', 'Dance movement psychotherapist', 'Data scientist', 'Database administrator', 'Dealer', 'Designer, ceramics/pottery', 'Designer, exhibition/display', 'Designer, furniture', 'Designer, industrial/product', 'Designer, interior/spatial', 'Designer, jewellery', 'Designer, multimedia', 'Designer, television/film set', 'Designer, textile', 'Development worker, community', 'Development worker, international aid', 'Diagnostic radiographer', 'Dispensing optician', 'Doctor, general practice', 'Doctor, hospital', 'Drilling engineer', 'Early years teacher', 'Ecologist', 'Economist', 'Editor, commissioning', 'Editor, film/video', 'Editor, magazine features', 'Education administrator', 'Education officer, community', 'Education officer, museum', 'Educational psychologist', 'Electrical engineer', 'Electronics engineer', 'Embryologist, clinical', 'Emergency planning/management officer', 'Energy engineer', 'Energy manager', 'Engineer, aeronautical', 'Engineer, agricultural', 'Engineer, automotive', 'Engineer, biomedical', 'Engineer, broadcasting (operations)', 'Engineer, building services', 'Engineer, civil (consulting)', 'Engineer, civil (contracting)', 'Engineer, communications', 'Engineer, control and instrumentation', 'Engineer, drilling', 'Engineer, electronics', 'Engineer, land', 'Engineer, maintenance', 'Engineer, manufacturing', 'Engineer, materials', 'Engineer, mining', 'Engineer, petroleum', 'Engineer, production', 'Engineer, structural', 'Engineer, technical sales', 'Engineer, water', 'Engineering geologist', 'English as a foreign language teacher', 'English as a second language teacher', 'Environmental consultant', 'Environmental education officer', 'Environmental health practitioner', 'Environmental manager', 'Equality and diversity officer', 'Equities trader', 'Estate manager/land agent', 'Event organiser', 'Exercise physiologist', 'Exhibition designer', 'Exhibitions officer, museum/gallery', 'Facilities manager', 'Farm manager', 'Field seismologist', 'Field trials officer', 'Film/video editor', 'Financial adviser', 'Financial trader', 'Fine artist', 'Firefighter', 'Fisheries officer', 'Fitness centre manager', 'Forensic psychologist', 'Freight forwarder', 'Furniture conservator/restorer', 'Furniture designer', 'Further education lecturer', 'Futures trader', 'Gaffer', 'Garment/textile technologist', 'General practice doctor', 'Geneticist, molecular', 'Geochemist', 'Geologist, engineering', 'Geologist, wellsite', 'Geophysicist/field seismologist', 'Geoscientist', 'Glass blower/designer', 'Health and safety adviser', 'Health physicist', 'Health promotion specialist', 'Health service manager', 'Health visitor', 'Herbalist', 'Heritage manager', 'Herpetologist', 'Higher education careers adviser', 'Historic buildings inspector/conservation officer', 'Horticultural consultant', 'Horticultural therapist', 'Horticulturist, commercial', 'Hospital doctor', 'Hospital pharmacist', 'Hotel manager', 'Human resources officer', 'Hydrogeologist', 'Hydrographic surveyor', 'Hydrologist', 'IT consultant', 'IT trainer', 'Illustrator', 'Immigration officer', 'Immunologist', 'Industrial/product designer', 'Information systems manager', 'Insurance broker', 'Insurance claims handler', 'Insurance risk surveyor', 'Insurance underwriter', 'Intelligence analyst', 'Interior and spatial designer', 'Interpreter', 'Investment analyst', 'Investment banker, corporate', 'Investment banker, operational', 'Jewellery designer', 'Journalist, newspaper', 'Land', 'Land/geomatics surveyor', 'Landscape architect', 'Lawyer', 'Learning disability nurse', 'Learning mentor', 'Lecturer, further education', 'Lecturer, higher education', 'Leisure centre manager', 'Lexicographer', 'Librarian, academic', 'Librarian, public', 'Licensed conveyancer', 'Local government officer', 'Location manager', 'Logistics and distribution manager', 'Loss adjuster, chartered', 'Magazine features editor', 'Magazine journalist', 'Maintenance engineer', 'Make', 'Management consultant', 'Manufacturing engineer', 'Manufacturing systems engineer', 'Market researcher', 'Marketing executive', 'Materials engineer', 'Mechanical engineer', 'Media buyer', 'Media planner', 'Medical physicist', 'Medical sales representative', 'Medical secretary', 'Medical technical officer', 'Mental health nurse', 'Merchandiser, retail', 'Metallurgist', 'Minerals surveyor', 'Mining engineer', 'Mudlogger', 'Multimedia programmer', 'Museum education officer', 'Museum/gallery conservator', 'Museum/gallery exhibitions officer', 'Music therapist', 'Music tutor', 'Musician', 'Nature conservation officer', 'Naval architect', 'Network engineer', 'Neurosurgeon', "Nurse, children's", 'Nurse, mental health', 'Nutritional therapist', 'Occupational hygienist', 'Occupational psychologist', 'Occupational therapist', 'Oceanographer', 'Oncologist', 'Operational investment banker', 'Operational researcher', 'Operations geologist', 'Optician, dispensing', 'Optometrist', 'Orthoptist', 'Osteopath', 'Outdoor activities/education manager', 'Paediatric nurse', 'Paramedic', 'Patent attorney', 'Pathologist', 'Pension scheme manager', 'Pensions consultant', 'Petroleum engineer', 'Pharmacist, community', 'Pharmacist, hospital', 'Pharmacologist', 'Physicist, medical', 'Physiological scientist', 'Physiotherapist', 'Phytotherapist', 'Pilot, airline', 'Planning and development surveyor', 'Plant breeder/geneticist', 'Podiatrist', 'Police officer', "Politician's assistant", 'Presenter, broadcasting', 'Press photographer', 'Press sub', 'Primary school teacher', 'Prison officer', 'Private music teacher', 'Probation officer', 'Producer, radio', 'Producer, television/film/video', 'Product designer', 'Product manager', 'Product/process development scientist', 'Production assistant, radio', 'Production assistant, television', 'Production engineer', 'Production manager', 'Professor Emeritus', 'Programme researcher, broadcasting/film/video', 'Programmer, applications', 'Programmer, multimedia', 'Psychiatric nurse', 'Psychiatrist', 'Psychologist, clinical', 'Psychologist, counselling', 'Psychologist, forensic', 'Psychologist, sport and exercise', 'Psychotherapist', 'Psychotherapist, child', 'Public affairs consultant', 'Public house manager', 'Public librarian', 'Public relations account executive', 'Public relations officer', 'Purchasing manager', 'Quantity surveyor', 'Quarry manager', 'Race relations officer', 'Radio broadcast assistant', 'Radio producer', 'Radiographer, diagnostic', 'Radiographer, therapeutic', 'Records manager', 'Regulatory affairs officer', 'Research officer, political party', 'Research officer, trade union', 'Research scientist (life sciences)', 'Research scientist (maths)', 'Research scientist (medical)', 'Research scientist (physical sciences)', 'Restaurant manager, fast food', 'Retail banker', 'Retail buyer', 'Retail manager', 'Retail merchandiser', 'Risk analyst', 'Rural practice surveyor', 'Sales executive', 'Sales professional, IT', 'Science writer', 'Scientific laboratory technician', 'Scientist, audiological', 'Scientist, biomedical', 'Scientist, clinical (histocompatibility and immunogenetics)', 'Scientist, marine', 'Scientist, physiological', 'Scientist, research (maths)', 'Scientist, research (medical)', 'Scientist, research (physical sciences)', 'Secondary school teacher', 'Secretary/administrator', 'Seismic interpreter', 'Senior tax professional/tax inspector', 'Set designer', 'Site engineer', 'Social research officer, government', 'Social researcher', 'Software engineer', 'Soil scientist', 'Solicitor, Scotland', 'Special educational needs teacher', 'Special effects artist', 'Sport and exercise psychologist', 'Sports administrator', 'Sports development officer', 'Stage manager', 'Statistician', 'Structural engineer', 'Sub', 'Surgeon', 'Surveyor, hydrographic', 'Surveyor, land/geomatics', 'Surveyor, minerals', 'Surveyor, mining', 'Surveyor, rural practice', 'Systems analyst', 'Systems developer', 'TEFL teacher', 'Tax adviser', 'Tax inspector', 'Teacher, English as a foreign language', 'Teacher, adult education', 'Teacher, early years/pre', 'Teacher, primary school', 'Teacher, secondary school', 'Teacher, special educational needs', 'Teaching laboratory technician', 'Technical brewer', 'Telecommunications researcher', 'Television camera operator', 'Television floor manager', 'Television production assistant', 'Television/film/video producer', 'Textile designer', 'Theatre director', 'Theatre manager', 'Theme park manager', 'Therapist, art', 'Therapist, drama', 'Therapist, horticultural', 'Therapist, music', 'Therapist, occupational', 'Therapist, sports', 'Tour manager', 'Tourism officer', 'Tourist information centre manager', 'Town planner', 'Toxicologist', 'Trade mark attorney', 'Trading standards officer', 'Training and development officer', 'Transport planner', 'Travel agency manager', 'Tree surgeon', 'Video editor', 'Visual merchandiser', 'Volunteer coordinator', 'Warden/ranger', 'Waste management officer', 'Water engineer', 'Water quality scientist', 'Web designer', 'Wellsite geologist', 'Writer']

# === Load artifacts ===
artifacts = load_artifacts()
models = artifacts["models"]
scaler = artifacts["scaler"]
features = artifacts["features"]
# merchant_list = artifacts["merchant_list"]
# category_list = artifacts["category_list"]
# job_list = artifacts["job_list"]

# === App Title ===
#st.set_page_config(page_title="Fraud Detection App", layout="centered")
st.title("üí≥ Credit Card Fraud Detection")
st.markdown("Please fill in transaction details to check if it's fraudulent.")

st.warning("‚ö†Ô∏è Avoid opening multiple tabs of this app simultaneously to prevent session crashes.")

# === Sidebar Input ===
with st.form("fraud_form"):
    st.subheader("üìã Transaction Details")

    col1, col2 = st.columns(2)
    with col1:
        merchant_input = st.selectbox("üõí Merchant", merchant_list)
        category_input = st.selectbox("üì¶ Category", category_list)
    with col2:
        job_input = st.selectbox("üë®‚Äçüíº Customer Job", job_list)
        amount_input = st.slider("üí∞ Transaction Amount ($)", 0.0, 5000.0, 100.0, step=10.0)

    selected_model = st.selectbox("‚öôÔ∏è Choose ML Model", list(models.keys()))

    submit = st.form_submit_button("üö® Detect Fraud")

# === Prediction Triggered ===
if submit:
    try:
        # Category encoding
        merchant_code = pd.Series([merchant_input], dtype="category").cat.set_categories(merchant_list).cat.codes[0]
        category_code = pd.Series([category_input], dtype="category").cat.set_categories(category_list).cat.codes[0]
        job_code = pd.Series([job_input], dtype="category").cat.set_categories(job_list).cat.codes[0]

        # Scale transaction amount
        scaled_amt = scaler.transform([[amount_input]])[0][0]

        # Create input dict
        input_dict = {
            "merchant": merchant_code,
            "category": category_code,
            "job": job_code,
            "scaled_amt": scaled_amt
        }

        for col in features:
            if col not in input_dict:
                input_dict[col] = 0

        input_df = pd.DataFrame([input_dict])[features]

        # Make prediction
        model = models[selected_model]
        prob = model.predict_proba(input_df)[0][1]

        # Display result
        st.subheader("üîç Prediction Result")
        st.success(f"Model: **{selected_model}**")
        st.metric("Fraud Probability", f"{prob * 100:.2f}%")

    except Exception as e:
        st.error(f"‚ùå Error: {e}")







# import streamlit as st
# import pandas as pd
# import joblib
# import numpy as np

# # === Load once using Streamlit cache ===
# @st.cache_resource
# def load_model():
#     model = joblib.load("../models/xgboost.pkl")
#     scaler = joblib.load("../models/scaler.pkl")
#     features = joblib.load("../models/feature_columns.pkl")
#     return model, scaler, features




# import os

# # Use absolute safe path for loading models
# BASE_DIR = os.path.dirname(os.path.abspath(__file__))
# MODEL_PATH = os.path.join(BASE_DIR, "models", "xgboost.pkl")
# SCALER_PATH = os.path.join(BASE_DIR, "models", "scaler.pkl")
# FEATURES_PATH = os.path.join(BASE_DIR, "models", "feature_columns.pkl")

# @st.cache_resource
# def load_model():
#     model = joblib.load(MODEL_PATH)
#     scaler = joblib.load(SCALER_PATH)
#     features = joblib.load(FEATURES_PATH)
#     return model, scaler, features

# model, scaler, feature_columns = load_model()

# # === Streamlit UI ===
# st.set_page_config(page_title="Credit Card Fraud Detection", layout="centered")
# st.title("üí≥ Credit Card Fraud Detection")
# st.markdown("Enter transaction details below:")

# # === Form Input ===
# with st.form("prediction_form"):
#     input_data = {}
#     for col in feature_columns:
#         input_data[col] = st.text_input(f"{col}", placeholder="Enter value")

#     submitted = st.form_submit_button("Predict")

# # === Prediction ===
# if submitted:
#     try:
#         input_df = pd.DataFrame([input_data])
#         input_df = input_df.astype(float)
#         input_df_scaled = scaler.transform(input_df)

#         prediction = model.predict(input_df_scaled)[0]
#         prob = model.predict_proba(input_df_scaled)[0][1]

#         st.success("Prediction complete!")
#         if prediction == 1:
#             st.error(f"‚ö†Ô∏è This transaction is predicted as **FRAUD** with probability {prob:.2f}")
#         else:
#             st.success(f"‚úÖ This transaction is predicted as **NON-FRAUD** with probability {1 - prob:.2f}")

#     except Exception as e:
#         st.error(f"Error in prediction: {e}")
